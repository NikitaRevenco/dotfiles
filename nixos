# vim: set filetype=nix :
{ config, lib, pkgs, ... }:

{
  imports = [ /etc/nixos/hardware-configuration.nix ];
  
  environment.systemPackages = with pkgs; [
    sof-firmware
    wezterm
    bat
    ripgrep
    fzf
    zoxide
    eza
    xclip
  ];

  programs = {
    zsh.enable = true;
    git.enable = true;
    neovim.enable = true;
    firefox.enable = true;
  };
  
  fonts.packages = with pkgs; [
    (nerdfonts.override { fonts = [ "JetBrainsMono" ]; }) 
  ];
  
  users.defaultUserShell = pkgs.zsh;
  
  services.pipewire = {
    enable = true;
    pulse.enable = true;
    alsa.enable = true;
    alsa.support32Bit = true;
  };
  
  services.xserver.displayManager.startx.enable = true;
  services.xserver.enable = true;
  services.xserver.windowManager.i3.enable = true;

  networking.hostName = "nixos"; # Define your hostname.
  time.timeZone = "Europe/London";
  i18n.defaultLocale = "en_GB.UTF-8";
  services.xserver.xkb.layout = "us";
  services.libinput.enable = true;
  users.users.e = {
    isNormalUser = true;
    extraGroups = [ "wheel" ]; # Enable ‘sudo’ for the user.
  };

  fileSystems."/".options = [ "noatime" "nodiratime" "discard" ];
  
  boot.kernelParams = [ "intel_pstate=no_hwp" ];
  boot.loader.grub.enable = true;
  boot.loader.grub.device = "nodev";
  boot.loader.grub.efiSupport = true;
  boot.loader.efi.canTouchEfiVariables = true;
  boot.initrd.luks.devices.cryptroot.device = "/dev/disk/by-uuid/5c45cf13-bf82-447b-b7d6-31714d8ed082";
  
  networking.wireless.enable = true;
  system.stateVersion = "24.05";
}
